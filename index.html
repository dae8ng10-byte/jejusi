<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제주 역사 초월: 타임라인 워커스</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
</head>
<body>
    <header>
        <h1>⏳ 제주 역사 초월: 타임라인 워커스 🏃‍♀️</h1>
        <p>역사적 그림자를 수집하고, 제주 불멸의 정신을 완성하세요.</p>
    </header>

    <main>
        <section id="project-intro">
            <h2>프로젝트 개요</h2>
            <p>설문대할망이 내린 **비밀 편지**를 따라 제주 창조의 정신, 소망, 평화의 그림자를 수집하는 몰입형 가족 학습 여행입니다.</p>
        </section>

        <hr>

        <section id="mission-status">
            <h2>할망의 그림자 수집 현황 (1일차 여정)</h2>
            <div class="shadow-collection">
                <div id="shadow-1" class="shadow-item">
                    <h3>창조의 그림자</h3>
                    <p class="location">장소: 설문대여성문화센터 (OT/편지 수신)</p>
                    <div class="status-indicator incomplete">미수집</div>
                </div>
                <div id="shadow-2" class="shadow-item">
                    <h3>소망의 그림자</h3>
                    <p class="location">장소: 돌문화공원</p>
                    <div class="status-indicator incomplete">미수집</div>
                </div>
                <div id="shadow-3" class="shadow-item">
                    <h3>평화의 그림자</h3>
                    <p class="location">장소: 4.3 평화공원</p>
                    <div class="status-indicator incomplete">미수집</div>
                </div>
            </div>
            <button id="trigger-next-mission" onclick="triggerNextMission()">다음 '미수집' 그림자 미션 시작</button>
        </section>

        <hr>

        <section id="final-artifact">
            <h2>✨ 최종 보상: 야시장 바우처</h2>
            <div id="artifact-display">
                <p id="artifact-message" class="message">세 시대의 '역사적 그림자'를 모두 모으면, **야시장에서 사용할 수 있는 바우처** 교환권이 여기에 나타납니다.</p>
                <img id="final-artifact-image" src="" alt="야시장 바우처 이미지" style="display: none;">
            </div>
            <button id="view-ar-exhibition" disabled>바우처 교환 안내 보기</button>
        </section>
    </main>

    <footer>
        <p>&copy; 설문대할망의 비밀 편지 (가족 학습 여행)</p>
    </footer>

    <div id="mission-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            
            <div id="mission-step-1">
                <h3 id="modal-title-1"></h3>
                <p class="mission-guide">당신은 **<span id="modal-location-1"></span>**에 도착했습니다. 할망의 메시지를 확인하세요.</p>
                
                <div class="shadow-image-container">
                    <img id="step1-shadow-image" src="" alt="역사적 그림자" class="shadow-effect">
                </div>

                <div class="historical-data-box">
                    <h4>📜 할망의 메시지 (현장 사료)</h4>
                    <p id="historical-data"></p>
                </div>
                
                <button id="start-photo-mission" onclick="startPhotoMission()">할망의 뜻 확인 완료 및 인증 시작</button>
            </div>

            <div id="mission-step-2" style="display: none;">
                <h3 id="modal-title-2" class="text-xl font-bold">인증 사진 촬영 (셀카 미션)</h3>
                <p id="mission-step-2-guide" class="mission-guide">현장의 영속적인 정신을 담아 **인증 사진**을 촬영하고 '그림자'를 수집하세요.</p>

                <div class="camera-container">
                    <video id="camera-feed" autoplay playsinline></video>
                    <img id="overlay-shadow-image" src="" alt="오버레이 그림자" class="overlay-effect">
                    <canvas id="photo-canvas" style="display:none;"></canvas>
                </div>

                <div class="camera-controls">
                    <button id="capture-button" onclick="capturePhoto()">📸 사진 찍기</button>
                    <button id="submit-button" onclick="submitPhotoAndComplete()" disabled style="display:none; background-color: #28a745;">✅ 그림자 수집하기</button>
                    <button id="retake-button" onclick="retakePhoto()" style="display:none; margin-top: 10px; background-color: #ffaa33;">🔄 다시 찍기</button>
                </div>

                <p id="photo-feedback" class="feedback"></p>
            </div>
            
        </div>
    </div>
</body>
</html>